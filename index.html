<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Há»c Tiáº¿ng Nháº­t - Thá»ƒ ThÆ°á»ng (æ™®é€šå½¢)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'sans': ['Inter', 'sans-serif'],
            'japanese': ['Noto Sans JP', 'sans-serif'],
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.6s ease-out',
            'bounce-in': 'bounceIn 0.5s ease-out',
            'shimmer': 'shimmer 2s infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideUp: {
              '0%': { transform: 'translateY(20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' },
            },
            bounceIn: {
              '0%': { transform: 'scale(0.3)', opacity: '0' },
              '50%': { transform: 'scale(1.05)' },
              '70%': { transform: 'scale(0.9)' },
              '100%': { transform: 'scale(1)', opacity: '1' },
            },
            shimmer: {
              '0%': { left: '-100%' },
              '100%': { left: '100%' },
            }
          }
        }
      },
      darkMode: 'class',
    }
  </script>

  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .glass-effect {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .shimmer::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      animation: shimmer 2s infinite;
    }
  </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
  <!-- Loading Screen -->
  <div id="loading-screen"
    class="fixed inset-0 bg-white dark:bg-gray-900 flex flex-col items-center justify-center z-50">
    <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-t-transparent mb-4"></div>
    <div class="text-xl font-medium text-gray-700 dark:text-gray-300 mb-2">Äang táº£i dá»¯ liá»‡u...</div>
    <div class="w-64 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
      <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full animate-pulse"
        style="width: 100%; animation-duration: 2s;"></div>
    </div>
  </div>

  <!-- Header -->
  <header
    class="sticky top-0 z-40 glass-effect bg-white/80 dark:bg-gray-900/80 border-b border-gray-200 dark:border-gray-700">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <div class="flex items-center space-x-3">
          <i class="fas fa-torii-gate text-2xl gradient-text"></i>
          <h1 class="text-xl font-bold gradient-text font-japanese">æ—¥æœ¬èªå­¦ç¿’</h1>
        </div>

        <!-- Navigation -->
        <nav class="hidden md:flex space-x-2">
          <button class="nav-btn px-4 py-2 rounded-lg font-medium transition-all duration-300 bg-blue-500 text-white"
            data-page="theory">
            <i class="fas fa-book mr-2"></i>LÃ½ Thuyáº¿t
          </button>
          <button
            class="nav-btn px-4 py-2 rounded-lg font-medium transition-all duration-300 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
            data-page="practice">
            <i class="fas fa-pencil-alt mr-2"></i>Thá»±c HÃ nh
          </button>
          <button
            class="nav-btn px-4 py-2 rounded-lg font-medium transition-all duration-300 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
            data-page="review">
            <i class="fas fa-redo mr-2"></i>Ã”n Táº­p
          </button>
          <button
            class="nav-btn px-4 py-2 rounded-lg font-medium transition-all duration-300 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
            data-page="statistics">
            <i class="fas fa-chart-bar mr-2"></i>Thá»‘ng KÃª
          </button>
        </nav>

        <!-- Theme Toggle -->
        <button id="theme-toggle"
          class="p-2 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
          <i class="fas fa-moon dark:hidden"></i>
          <i class="fas fa-sun hidden dark:block"></i>
        </button>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg text-gray-600 dark:text-gray-300">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu"
      class="hidden md:hidden border-t border-gray-200 dark:border-gray-700 bg-white/90 dark:bg-gray-900/90">
      <div class="px-4 py-2 space-y-1">
        <button class="mobile-nav-btn w-full text-left px-3 py-2 rounded-lg font-medium bg-blue-500 text-white"
          data-page="theory">
          <i class="fas fa-book mr-2"></i>LÃ½ Thuyáº¿t
        </button>
        <button
          class="mobile-nav-btn w-full text-left px-3 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
          data-page="practice">
          <i class="fas fa-pencil-alt mr-2"></i>Thá»±c HÃ nh
        </button>
        <button
          class="mobile-nav-btn w-full text-left px-3 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
          data-page="review">
          <i class="fas fa-redo mr-2"></i>Ã”n Táº­p
        </button>
        <button
          class="mobile-nav-btn w-full text-left px-3 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
          data-page="statistics">
          <i class="fas fa-chart-bar mr-2"></i>Thá»‘ng KÃª
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Theory Page -->
    <div id="theory-page" class="page animate-slide-up">
      <!-- Hero Section -->
      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-6xl font-bold gradient-text mb-4 font-japanese">
          æ™®é€šå½¢ (Thá»ƒ ThÆ°á»ng)
        </h1>
        <p class="text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
          Náº¯m vá»¯ng kiáº¿n thá»©c cÆ¡ báº£n vá» thá»ƒ thÆ°á»ng trong tiáº¿ng Nháº­t má»™t cÃ¡ch dá»… dÃ ng vÃ  trá»±c quan
        </p>
      </div>

      <!-- Enhanced Mind Map -->
      <div
        class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 mb-12 border border-gray-200 dark:border-gray-700">
        <h2 class="text-2xl font-bold text-center mb-8 gradient-text">
          <i class="fas fa-sitemap mr-3"></i>SÆ¡ Äá»“ Kiáº¿n Thá»©c - Thá»ƒ ThÆ°á»ng
        </h2>

        <!-- Central Node -->
        <div class="flex flex-col items-center">
          <div class="gradient-bg text-white px-8 py-6 rounded-2xl text-2xl font-bold shadow-2xl mb-8 font-japanese">
            æ™®é€šå½¢<br><small class="text-sm opacity-90">(Thá»ƒ ThÆ°á»ng)</small>
          </div>

          <!-- Branches -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 w-full">
            <!-- Verbs -->
            <div
              class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-xl border-l-4 border-blue-500 hover:shadow-lg transition-all duration-300 hover:scale-105">
              <div class="flex items-center mb-4">
                <i class="fas fa-running text-blue-500 text-2xl mr-3"></i>
                <h3 class="text-lg font-bold text-blue-700 dark:text-blue-300">Äá»™ng Tá»«</h3>
              </div>
              <div class="space-y-2 text-sm">
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">è¡Œãã¾ã™ â†’ è¡Œã</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">è¡Œãã¾ã—ãŸ â†’ è¡Œã£ãŸ</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">è¡Œãã¾ã›ã‚“ â†’ è¡Œã‹ãªã„</div>
              </div>
            </div>

            <!-- i-Adjectives -->
            <div
              class="bg-gradient-to-br from-green-50 to-emerald-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-xl border-l-4 border-green-500 hover:shadow-lg transition-all duration-300 hover:scale-105">
              <div class="flex items-center mb-4">
                <i class="fas fa-palette text-green-500 text-2xl mr-3"></i>
                <h3 class="text-lg font-bold text-green-700 dark:text-green-300">TÃ­nh Tá»« ã„</h3>
              </div>
              <div class="space-y-2 text-sm">
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãŠã„ã—ã„ã§ã™ â†’ ãŠã„ã—ã„</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãŠã„ã—ã‹ã£ãŸ</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãŠã„ã—ããªã„</div>
              </div>
            </div>

            <!-- na-Adjectives -->
            <div
              class="bg-gradient-to-br from-purple-50 to-violet-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-xl border-l-4 border-purple-500 hover:shadow-lg transition-all duration-300 hover:scale-105">
              <div class="flex items-center mb-4">
                <i class="fas fa-star text-purple-500 text-2xl mr-3"></i>
                <h3 class="text-lg font-bold text-purple-700 dark:text-purple-300">TÃ­nh Tá»« ãª</h3>
              </div>
              <div class="space-y-2 text-sm">
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãã‚Œã„ã§ã™ â†’ ãã‚Œã„ã </div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãã‚Œã„ã ã£ãŸ</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">ãã‚Œã„ã˜ã‚ƒãªã„</div>
              </div>
            </div>

            <!-- Nouns -->
            <div
              class="bg-gradient-to-br from-orange-50 to-amber-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-xl border-l-4 border-orange-500 hover:shadow-lg transition-all duration-300 hover:scale-105">
              <div class="flex items-center mb-4">
                <i class="fas fa-cube text-orange-500 text-2xl mr-3"></i>
                <h3 class="text-lg font-bold text-orange-700 dark:text-orange-300">Danh Tá»«</h3>
              </div>
              <div class="space-y-2 text-sm">
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">å­¦ç”Ÿã§ã™ â†’ å­¦ç”Ÿã </div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">å­¦ç”Ÿã ã£ãŸ</div>
                <div class="bg-white dark:bg-gray-800 p-2 rounded font-japanese">å­¦ç”Ÿã˜ã‚ƒãªã„</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Theory Cards -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- What is Casual Form -->
        <div
          class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
          <h3 class="text-2xl font-bold mb-6 flex items-center text-blue-600 dark:text-blue-400">
            <i class="fas fa-info-circle mr-3"></i>Thá»ƒ ThÆ°á»ng lÃ  gÃ¬?
          </h3>
          <div class="space-y-4 text-gray-700 dark:text-gray-300">
            <p>Thá»ƒ ThÆ°á»ng (æ™®é€šå½¢) Ä‘Æ°á»£c sá»­ dá»¥ng trong:</p>
            <ul class="space-y-3">
              <li class="flex items-start">
                <i class="fas fa-comments text-blue-500 mt-1 mr-3"></i>
                <span>CÃ¡c tÃ¬nh huá»‘ng thÃ¢n máº­t, khÃ´ng trang trá»ng</span>
              </li>
              <li class="flex items-start">
                <i class="fas fa-users text-green-500 mt-1 mr-3"></i>
                <span>NÃ³i chuyá»‡n vá»›i báº¡n bÃ¨, ngÆ°á»i thÃ¢n</span>
              </li>
              <li class="flex items-start">
                <i class="fas fa-book-open text-purple-500 mt-1 mr-3"></i>
                <span>VÄƒn viáº¿t khÃ´ng trang trá»ng (blog, diary, manga)</span>
              </li>
              <li class="flex items-start">
                <i class="fas fa-link text-orange-500 mt-1 mr-3"></i>
                <span>Káº¿t há»£p vá»›i cÃ¡c máº«u ngá»¯ phÃ¡p Ä‘áº·c biá»‡t</span>
              </li>
            </ul>
          </div>
        </div>

        <!-- Conversion Rules -->
        <div
          class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
          <h3 class="text-2xl font-bold mb-6 flex items-center text-green-600 dark:text-green-400">
            <i class="fas fa-exchange-alt mr-3"></i>Quy Táº¯c Chuyá»ƒn Äá»•i
          </h3>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-200 dark:border-gray-600">
                  <th class="text-left py-2 text-gray-700 dark:text-gray-300">Loáº¡i tá»«</th>
                  <th class="text-left py-2 text-gray-700 dark:text-gray-300">Lá»‹ch sá»±</th>
                  <th class="text-left py-2 text-gray-700 dark:text-gray-300">ThÆ°á»ng</th>
                </tr>
              </thead>
              <tbody class="space-y-2">
                <tr class="border-b border-gray-100 dark:border-gray-700">
                  <td class="py-2 font-medium">Äá»™ng tá»«</td>
                  <td class="py-2 font-japanese">Vã¾ã™</td>
                  <td class="py-2 font-japanese text-blue-600">Vã‚‹</td>
                </tr>
                <tr class="border-b border-gray-100 dark:border-gray-700">
                  <td class="py-2 font-medium">TÃ­nh tá»« ã„</td>
                  <td class="py-2 font-japanese">Aã„ã§ã™</td>
                  <td class="py-2 font-japanese text-green-600">Aã„</td>
                </tr>
                <tr class="border-b border-gray-100 dark:border-gray-700">
                  <td class="py-2 font-medium">TÃ­nh tá»« ãª</td>
                  <td class="py-2 font-japanese">Aãªã§ã™</td>
                  <td class="py-2 font-japanese text-purple-600">Aã </td>
                </tr>
                <tr>
                  <td class="py-2 font-medium">Danh tá»«</td>
                  <td class="py-2 font-japanese">Nã§ã™</td>
                  <td class="py-2 font-japanese text-orange-600">Nã </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Learning Tips -->
        <div
          class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
          <h3 class="text-2xl font-bold mb-6 flex items-center text-yellow-600 dark:text-yellow-400">
            <i class="fas fa-lightbulb mr-3"></i>Máº¹o Há»c Táº­p
          </h3>
          <div class="space-y-4">
            <div class="flex items-start space-x-3">
              <i class="fas fa-repeat text-blue-500 mt-1"></i>
              <span>Luyá»‡n táº­p thÆ°á»ng xuyÃªn vá»›i báº¡n bÃ¨ ngÆ°á»i Nháº­t</span>
            </div>
            <div class="flex items-start space-x-3">
              <i class="fas fa-film text-red-500 mt-1"></i>
              <span>Xem anime, drama Ä‘á»ƒ nghe thá»ƒ thÆ°á»ng trong thá»±c táº¿</span>
            </div>
            <div class="flex items-start space-x-3">
              <i class="fas fa-book-reader text-green-500 mt-1"></i>
              <span>Äá»c manga, tin nháº¯n social media</span>
            </div>
            <div class="flex items-start space-x-3">
              <i class="fas fa-target text-purple-500 mt-1"></i>
              <span>Äá»«ng sá»£ sai - há»c tá»« sai láº§m</span>
            </div>
          </div>
        </div>

        <!-- Practical Applications -->
        <div
          class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-all duration-300">
          <h3 class="text-2xl font-bold mb-6 flex items-center text-purple-600 dark:text-purple-400">
            <i class="fas fa-puzzle-piece mr-3"></i>á»¨ng Dá»¥ng Thá»±c Táº¿
          </h3>
          <p class="mb-4 text-gray-700 dark:text-gray-300">Thá»ƒ thÆ°á»ng thÆ°á»ng xuáº¥t hiá»‡n trong cÃ¡c máº«u ngá»¯ phÃ¡p:</p>
          <div class="space-y-3">
            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
              <strong class="font-japanese text-blue-600">ã¨æ€ã„ã¾ã™</strong> - tÃ´i nghÄ© ráº±ng...
            </div>
            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
              <strong class="font-japanese text-green-600">ã§ã—ã‚‡ã†</strong> - cÃ³ láº½, pháº£i khÃ´ng
            </div>
            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
              <strong class="font-japanese text-purple-600">ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“</strong> - cÃ³ thá»ƒ
            </div>
            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
              <strong class="font-japanese text-orange-600">æ™‚ã€å‰ã«ã€å¾Œã§</strong> - khi, trÆ°á»›c, sau
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Practice Page -->
    <div id="practice-page" class="page hidden">
      <!-- Hero Section -->
      <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold gradient-text mb-4">Thá»±c HÃ nh BÃ i Táº­p</h1>
        <p class="text-xl text-gray-600 dark:text-gray-400">Luyá»‡n táº­p vÃ  kiá»ƒm tra kiáº¿n thá»©c thá»ƒ thÆ°á»ng</p>
      </div>

      <!-- Stats Dashboard -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div
          class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg text-center border border-gray-200 dark:border-gray-700">
          <i class="fas fa-check-circle text-3xl text-green-500 mb-2"></i>
          <div class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="correct-count">0</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">CÃ¢u ÄÃºng</div>
        </div>
        <div
          class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg text-center border border-gray-200 dark:border-gray-700">
          <i class="fas fa-clipboard-list text-3xl text-blue-500 mb-2"></i>
          <div class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="total-count">0</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">Tá»•ng CÃ¢u</div>
        </div>
        <div
          class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg text-center border border-gray-200 dark:border-gray-700">
          <i class="fas fa-fire text-3xl text-orange-500 mb-2"></i>
          <div class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="streak-count">0</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">Streak</div>
        </div>
        <div
          class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg text-center border border-gray-200 dark:border-gray-700">
          <i class="fas fa-percentage text-3xl text-purple-500 mb-2"></i>
          <div class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="accuracy-rate">0%</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">Äá»™ ChÃ­nh XÃ¡c</div>
        </div>
      </div>

      <!-- Exercise Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="exercise-grid">
        <!-- Exercise cards will be populated by JavaScript -->
      </div>
    </div>

    <!-- Review Page -->
    <div id="review-page" class="page hidden">
      <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold gradient-text mb-4">Ã”n Táº­p CÃ¢u Sai</h1>
        <p class="text-xl text-gray-600 dark:text-gray-400">Ã”n láº¡i nhá»¯ng cÃ¢u báº¡n Ä‘Ã£ lÃ m sai Ä‘á»ƒ há»c táº­p hiá»‡u quáº£ hÆ¡n</p>
      </div>

      <div id="review-content" class="space-y-6">
        <!-- Review content will be populated by JavaScript -->
      </div>
    </div>

    <!-- Statistics Page -->
    <div id="statistics-page" class="page hidden">
      <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold gradient-text mb-4">Thá»‘ng KÃª Há»c Táº­p</h1>
        <p class="text-xl text-gray-600 dark:text-gray-400">Theo dÃµi tiáº¿n Ä‘á»™ há»c táº­p cá»§a báº¡n</p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Progress Chart -->
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-xl font-bold mb-4">Tiáº¿n Äá»™ Theo Thá»i Gian</h3>
          <div id="progress-chart" class="h-64 flex items-center justify-center text-gray-500">
            Biá»ƒu Ä‘á»“ tiáº¿n Ä‘á»™ sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y
          </div>
        </div>

        <!-- Exercise Progress -->
        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700">
          <h3 class="text-xl font-bold mb-4">Tiáº¿n Äá»™ BÃ i Táº­p</h3>
          <div id="exercise-progress" class="space-y-4">
            <!-- Exercise progress will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Quiz Container -->
    <div id="quiz-container"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
        <!-- Quiz Header -->
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold gradient-text" id="quiz-title">BÃ i Táº­p</h2>
            <button id="close-quiz" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>

          <div class="flex items-center space-x-4">
            <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-3">
              <div
                class="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-300 relative overflow-hidden"
                id="quiz-progress-bar" style="width: 0%">
                <div class="absolute inset-0 shimmer"></div>
              </div>
            </div>
            <span class="text-sm font-medium text-gray-600 dark:text-gray-400" id="quiz-progress-text">1/25</span>
          </div>
        </div>

        <!-- Question Card -->
        <div class="p-6">
          <div
            class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-700 dark:to-gray-600 rounded-xl p-6 mb-6">
            <div class="text-lg mb-4" id="question-text">Chuyá»ƒn cÃ¢u sau sang thá»ƒ thÆ°á»ng:</div>
            <div class="text-2xl font-bold font-japanese mb-2 text-blue-700 dark:text-blue-300" id="japanese-sentence">
              ãŒã£ã“ã†ã« ã„ãã¾ã™ã€‚
            </div>
            <div class="text-gray-600 dark:text-gray-400 italic mb-4" id="vietnamese-meaning">(Ä‘i há»c)</div>
            <div class="text-lg mb-4">
              â†’ <span id="sentence-prefix">ãŒã£ã“ã†ã«</span>
              <span
                class="border-b-2 border-dashed border-blue-500 px-4 py-1 mx-2 min-w-[120px] inline-block text-center bg-white dark:bg-gray-800 rounded">_____</span>ã€‚
            </div>

            <!-- Answer Input -->
            <input type="text" id="answer-input"
              class="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-japanese text-lg bg-white dark:bg-gray-800 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all duration-300"
              placeholder="Nháº­p Ä‘Ã¡p Ã¡n báº±ng hiragana..." autocomplete="off">
          </div>

          <!-- Feedback -->
          <div id="feedback" class="mb-6"></div>

          <!-- Action Buttons -->
          <div class="flex flex-wrap gap-3 justify-center">
            <button id="check-btn"
              class="px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-medium transition-all duration-300 transform hover:scale-105">
              <i class="fas fa-check mr-2"></i>Kiá»ƒm Tra
            </button>
            <button id="next-btn"
              class="hidden px-6 py-3 bg-green-500 hover:bg-green-600 text-white rounded-xl font-medium transition-all duration-300 transform hover:scale-105">
              <i class="fas fa-arrow-right mr-2"></i>Tiáº¿p Theo
            </button>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex justify-between mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
            <button id="back-to-selection"
              class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
              <i class="fas fa-arrow-left mr-2"></i>Quay Láº¡i
            </button>
            <button id="retry-wrong"
              class="px-4 py-2 text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-200 transition-colors">
              <i class="fas fa-redo mr-2"></i>LÃ m Láº¡i CÃ¢u Sai
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Results Modal -->
    <div id="results-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md text-center p-8">
        <div class="text-6xl mb-4">ğŸ‰</div>
        <h2 class="text-3xl font-bold mb-4 gradient-text">HoÃ n ThÃ nh!</h2>
        <div class="text-4xl font-bold mb-2" id="final-score">0/0</div>
        <div class="text-gray-600 dark:text-gray-400 mb-6" id="final-message">ChÃºc má»«ng báº¡n!</div>

        <div class="grid grid-cols-3 gap-4 mb-6">
          <div>
            <div class="text-2xl font-bold text-green-500" id="final-correct">0</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">ÄÃºng</div>
          </div>
          <div>
            <div class="text-2xl font-bold text-red-500" id="final-wrong">0</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Sai</div>
          </div>
          <div>
            <div class="text-2xl font-bold text-orange-500" id="final-skipped">0</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Bá» qua</div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-3">
          <button id="retry-exercise"
            class="flex-1 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
            <i class="fas fa-redo mr-2"></i>LÃ m Láº¡i
          </button>
          <button id="close-results"
            class="flex-1 px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
            <i class="fas fa-home mr-2"></i>Trang Chá»§
          </button>
        </div>
      </div>
    </div>
  </main>

  <script>
    // App State and Configuration
    class JapaneseApp {
      constructor() {
        this.currentExercise = null;
        this.currentQuestionIndex = 0;
        this.sessionStats = { correct: 0, total: 0, streak: 0, wrong: 0 };
        this.wrongAnswers = JSON.parse(localStorage.getItem('wrongAnswers') || '[]');
        this.globalStats = this.loadGlobalStats();
        this.questionsData = {};
        this.answersData = {};
        this.isDataLoaded = false;
        this.currentPage = 'theory';

        this.exerciseDefinitions = {
          'verbs-present': {
            title: 'Äá»™ng Tá»« - Hiá»‡n Táº¡i',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« hiá»‡n táº¡i tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-play',
            color: 'blue',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« hiá»‡n táº¡i:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã„ã¾ã™ â†’ ã† (Group 1): æ›¸ãã¾ã™ â†’ æ›¸ã</li>
                                <li>â€¢ ã¾ã™ â†’ ã‚‹ (Group 2): é£Ÿã¹ã¾ã™ â†’ é£Ÿã¹ã‚‹</li>
                                <li>â€¢ ã—ã¾ã™ â†’ ã™ã‚‹ (Irregular): å‹‰å¼·ã—ã¾ã™ â†’ å‹‰å¼·ã™ã‚‹</li>
                                <li>â€¢ ãã¾ã™ â†’ ãã‚‹ (Irregular): æ¥ã¾ã™ â†’ æ¥ã‚‹</li>
                            </ul>
                        `
          },
          'verbs-past': {
            title: 'Äá»™ng Tá»« - QuÃ¡ Khá»©',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« quÃ¡ khá»© tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-history',
            color: 'green',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« quÃ¡ khá»©:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãã¾ã—ãŸ â†’ ã„ãŸ: æ›¸ãã¾ã—ãŸ â†’ æ›¸ã„ãŸ</li>
                                <li>â€¢ ãã¾ã—ãŸ â†’ ã„ã : æ³³ãã¾ã—ãŸ â†’ æ³³ã„ã </li>
                                <li>â€¢ ã—ã¾ã—ãŸ â†’ ã—ãŸ: è©±ã—ã¾ã—ãŸ â†’ è©±ã—ãŸ</li>
                                <li>â€¢ ã¡ã¾ã—ãŸ â†’ ã£ãŸ: å¾…ã¡ã¾ã—ãŸ â†’ å¾…ã£ãŸ</li>
                                <li>â€¢ ã«ã¾ã—ãŸ â†’ ã‚“ã : æ­»ã«ã¾ã—ãŸ â†’ æ­»ã‚“ã </li>
                            </ul>
                        `
          },
          'verbs-negative': {
            title: 'Äá»™ng Tá»« - Phá»§ Äá»‹nh',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« phá»§ Ä‘á»‹nh tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-times-circle',
            color: 'red',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« phá»§ Ä‘á»‹nh:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãã¾ã›ã‚“ â†’ ã‹ãªã„: æ›¸ãã¾ã›ã‚“ â†’ æ›¸ã‹ãªã„</li>
                                <li>â€¢ ãã¾ã›ã‚“ â†’ ãŒãªã„: æ³³ãã¾ã›ã‚“ â†’ æ³³ãŒãªã„</li>
                                <li>â€¢ ã—ã¾ã›ã‚“ â†’ ã•ãªã„: è©±ã—ã¾ã›ã‚“ â†’ è©±ã•ãªã„</li>
                                <li>â€¢ ã¡ã¾ã›ã‚“ â†’ ãŸãªã„: å¾…ã¡ã¾ã›ã‚“ â†’ å¾…ãŸãªã„</li>
                                <li>â€¢ ã«ã¾ã›ã‚“ â†’ ãªãªã„: æ­»ã«ã¾ã›ã‚“ â†’ æ­»ãªãªã„</li>
                            </ul>
                        `
          },
          'verbs-past-negative': {
            title: 'Äá»™ng Tá»« - QuÃ¡ Khá»© Phá»§ Äá»‹nh',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« quÃ¡ khá»© phá»§ Ä‘á»‹nh tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-minus-circle',
            color: 'gray',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i Ä‘á»™ng tá»« quÃ¡ khá»© phá»§ Ä‘á»‹nh:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãã¾ã›ã‚“ã§ã—ãŸ â†’ ã‹ãªã‹ã£ãŸ</li>
                                <li>â€¢ ãã¾ã›ã‚“ã§ã—ãŸ â†’ ãŒãªã‹ã£ãŸ</li>
                                <li>â€¢ ã—ã¾ã›ã‚“ã§ã—ãŸ â†’ ã•ãªã‹ã£ãŸ</li>
                                <li>â€¢ ã¡ã¾ã›ã‚“ã§ã—ãŸ â†’ ãŸãªã‹ã£ãŸ</li>
                                <li>â€¢ ã«ã¾ã›ã‚“ã§ã—ãŸ â†’ ãªãªã‹ã£ãŸ</li>
                            </ul>
                        `
          },
          'adjectives-i': {
            title: 'TÃ­nh Tá»« ã„',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i tÃ­nh tá»« Ä‘uÃ´i ã„ tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-palette',
            color: 'purple',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i tÃ­nh tá»« ã„:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ Hiá»‡n táº¡i: ãŠã„ã—ã„ã§ã™ â†’ ãŠã„ã—ã„</li>
                                <li>â€¢ QuÃ¡ khá»©: ãŠã„ã—ã‹ã£ãŸã§ã™ â†’ ãŠã„ã—ã‹ã£ãŸ</li>
                                <li>â€¢ Phá»§ Ä‘á»‹nh: ãŠã„ã—ããªã„ã§ã™ â†’ ãŠã„ã—ããªã„</li>
                                <li>â€¢ QuÃ¡ khá»© PÄ: ãŠã„ã—ããªã‹ã£ãŸã§ã™ â†’ ãŠã„ã—ããªã‹ã£ãŸ</li>
                                <li>â€¢ Äáº·c biá»‡t: ã„ã„ã§ã™ â†’ ã„ã„ (quÃ¡ khá»©: ã‚ˆã‹ã£ãŸ)</li>
                            </ul>
                        `
          },
          'adjectives-na': {
            title: 'TÃ­nh Tá»« ãª',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i tÃ­nh tá»« Ä‘uÃ´i ãª tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-star',
            color: 'yellow',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i tÃ­nh tá»« ãª:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ Hiá»‡n táº¡i: ãã‚Œã„ã§ã™ â†’ ãã‚Œã„ã </li>
                                <li>â€¢ QuÃ¡ khá»©: ãã‚Œã„ã§ã—ãŸ â†’ ãã‚Œã„ã ã£ãŸ</li>
                                <li>â€¢ Phá»§ Ä‘á»‹nh: ãã‚Œã„ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ â†’ ãã‚Œã„ã˜ã‚ƒãªã„</li>
                                <li>â€¢ QuÃ¡ khá»© PÄ: ãã‚Œã„ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ â†’ ãã‚Œã„ã˜ã‚ƒãªã‹ã£ãŸ</li>
                            </ul>
                        `
          },
          'nouns': {
            title: 'Danh Tá»«',
            description: 'Luyá»‡n táº­p chuyá»ƒn Ä‘á»•i danh tá»« tá»« thá»ƒ lá»‹ch sá»± sang thá»ƒ thÆ°á»ng',
            icon: 'fas fa-cube',
            color: 'indigo',
            theory: `
                            <h4 class="font-bold mb-2">Quy táº¯c chuyá»ƒn Ä‘á»•i danh tá»«:</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ Hiá»‡n táº¡i: å­¦ç”Ÿã§ã™ â†’ å­¦ç”Ÿã </li>
                                <li>â€¢ QuÃ¡ khá»©: å­¦ç”Ÿã§ã—ãŸ â†’ å­¦ç”Ÿã ã£ãŸ</li>
                                <li>â€¢ Phá»§ Ä‘á»‹nh: å­¦ç”Ÿã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ â†’ å­¦ç”Ÿã˜ã‚ƒãªã„</li>
                                <li>â€¢ QuÃ¡ khá»© PÄ: å­¦ç”Ÿã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ â†’ å­¦ç”Ÿã˜ã‚ƒãªã‹ã£ãŸ</li>
                            </ul>
                        `
          },
          'grammar-patterns-must': {
            title: 'Ngá»¯ PhÃ¡p - Pháº£i LÃ m',
            description: 'Luyá»‡n táº­p máº«u ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ â†’ ãªã‘ã‚Œã°ãªã‚‰ãªã„',
            icon: 'fas fa-exclamation-triangle',
            color: 'orange',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "pháº£i lÃ m":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ â†’ ãªã‘ã‚Œã°ãªã‚‰ãªã„</li>
                                <li>â€¢ VÄ: è¡Œã‹ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ â†’ è¡Œã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„</li>
                                <li>â€¢ NghÄ©a: Pháº£i lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-ing': {
            title: 'Ngá»¯ PhÃ¡p - Äang LÃ m',
            description: 'Luyá»‡n táº­p máº«u ã¦ã„ã¾ã™ â†’ ã¦ã„ã‚‹',
            icon: 'fas fa-clock',
            color: 'cyan',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "Ä‘ang lÃ m":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã¦ã„ã¾ã™ â†’ ã¦ã„ã‚‹</li>
                                <li>â€¢ VÄ: èª­ã‚“ã§ã„ã¾ã™ â†’ èª­ã‚“ã§ã„ã‚‹</li>
                                <li>â€¢ NghÄ©a: Äang lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-forbidden': {
            title: 'Ngá»¯ PhÃ¡p - KhÃ´ng ÄÆ°á»£c',
            description: 'Luyá»‡n táº­p máº«u ã¦ã¯ã„ã‘ã¾ã›ã‚“ â†’ ã¦ã¯ã„ã‘ãªã„',
            icon: 'fas fa-ban',
            color: 'red',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "khÃ´ng Ä‘Æ°á»£c":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã¦ã¯ã„ã‘ã¾ã›ã‚“ â†’ ã¦ã¯ã„ã‘ãªã„</li>
                                <li>â€¢ VÄ: é£Ÿã¹ã¦ã¯ã„ã‘ã¾ã›ã‚“ â†’ é£Ÿã¹ã¦ã¯ã„ã‘ãªã„</li>
                                <li>â€¢ NghÄ©a: KhÃ´ng Ä‘Æ°á»£c lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-permission': {
            title: 'Ngá»¯ PhÃ¡p - CÃ³ Thá»ƒ LÃ m',
            description: 'Luyá»‡n táº­p máº«u ã¦ã‚‚ã„ã„ã§ã™ â†’ ã¦ã‚‚ã„ã„',
            icon: 'fas fa-check-circle',
            color: 'green',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "cÃ³ thá»ƒ lÃ m":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã¦ã‚‚ã„ã„ã§ã™ â†’ ã¦ã‚‚ã„ã„</li>
                                <li>â€¢ VÄ: é£Ÿã¹ã¦ã‚‚ã„ã„ã§ã™ â†’ é£Ÿã¹ã¦ã‚‚ã„ã„</li>
                                <li>â€¢ NghÄ©a: CÃ³ thá»ƒ lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-ability': {
            title: 'Ngá»¯ PhÃ¡p - CÃ³ Kháº£ NÄƒng',
            description: 'Luyá»‡n táº­p máº«u ã“ã¨ãŒã§ãã¾ã™ â†’ ã“ã¨ãŒã§ãã‚‹',
            icon: 'fas fa-medal',
            color: 'amber',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "cÃ³ kháº£ nÄƒng":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã“ã¨ãŒã§ãã¾ã™ â†’ ã“ã¨ãŒã§ãã‚‹</li>
                                <li>â€¢ VÄ: è©±ã™ã“ã¨ãŒã§ãã¾ã™ â†’ è©±ã™ã“ã¨ãŒã§ãã‚‹</li>
                                <li>â€¢ NghÄ©a: CÃ³ thá»ƒ lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-experience': {
            title: 'Ngá»¯ PhÃ¡p - ÄÃ£ Tá»«ng',
            description: 'Luyá»‡n táº­p máº«u ã“ã¨ãŒã‚ã‚Šã¾ã™ â†’ ã“ã¨ãŒã‚ã‚‹',
            icon: 'fas fa-history',
            color: 'violet',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "Ä‘Ã£ tá»«ng":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ã“ã¨ãŒã‚ã‚Šã¾ã™ â†’ ã“ã¨ãŒã‚ã‚‹</li>
                                <li>â€¢ VÄ: è¡Œã£ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ â†’ è¡Œã£ãŸã“ã¨ãŒã‚ã‚‹</li>
                                <li>â€¢ NghÄ©a: ÄÃ£ tá»«ng lÃ m gÃ¬ Ä‘Ã³</li>
                            </ul>
                        `
          },
          'grammar-patterns-alternation': {
            title: 'Ngá»¯ PhÃ¡p - LÃ m NÃ y LÃ m Kia',
            description: 'Luyá»‡n táº­p máº«u ãŸã‚Šã—ã¾ã™ â†’ ãŸã‚Šã™ã‚‹',
            icon: 'fas fa-exchange-alt',
            color: 'teal',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "lÃ m nÃ y lÃ m kia":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãŸã‚Šã—ã¾ã™ â†’ ãŸã‚Šã™ã‚‹</li>
                                <li>â€¢ VÄ: èª­ã‚“ã ã‚Šã—ã¾ã™ â†’ èª­ã‚“ã ã‚Šã™ã‚‹</li>
                                <li>â€¢ NghÄ©a: LÃ m viá»‡c nÃ y viá»‡c kia</li>
                            </ul>
                        `
          },
          'grammar-patterns-become': {
            title: 'Ngá»¯ PhÃ¡p - Trá»Ÿ NÃªn',
            description: 'Luyá»‡n táº­p máº«u ãªã‚Šã¾ã™ â†’ ãªã‚‹',
            icon: 'fas fa-arrow-up',
            color: 'sky',
            theory: `
                            <h4 class="font-bold mb-2">Máº«u ngá»¯ phÃ¡p "trá»Ÿ nÃªn":</h4>
                            <ul class="space-y-1 text-xs">
                                <li>â€¢ ãªã‚Šã¾ã™ â†’ ãªã‚‹</li>
                                <li>â€¢ VÄ: æš–ã‹ããªã‚Šã¾ã™ â†’ æš–ã‹ããªã‚‹</li>
                                <li>â€¢ NghÄ©a: Trá»Ÿ thÃ nh/trá»Ÿ nÃªn</li>
                            </ul>
                        `
          }
        };

        this.init();
      }

      async init() {
        this.setupEventListeners();
        this.loadTheme();

        // Load data
        await this.loadData();

        // Initialize UI
        this.updateStatsDisplay();
        this.renderExerciseCards();
        this.hideLoadingScreen();

        // Setup keyboard shortcuts
        this.setupKeyboardShortcuts();
      }

      async loadData() {
        try {
          const loadingText = document.querySelector('#loading-screen .text-xl');

          // Load questions
          loadingText.textContent = 'Äang táº£i cÃ¢u há»i...';
          const questionsResponse = await fetch('./questions.json');
          if (!questionsResponse.ok) {
            throw new Error(`KhÃ´ng thá»ƒ táº£i questions.json: ${questionsResponse.status}`);
          }
          this.questionsData = await questionsResponse.json();

          // Load answers
          loadingText.textContent = 'Äang táº£i Ä‘Ã¡p Ã¡n...';
          const answersResponse = await fetch('./answers.json');
          if (!answersResponse.ok) {
            throw new Error(`KhÃ´ng thá»ƒ táº£i answers.json: ${answersResponse.status}`);
          }
          this.answersData = await answersResponse.json();

          loadingText.textContent = 'HoÃ n thÃ nh!';
          this.isDataLoaded = true;

          console.log('ÄÃ£ táº£i thÃ nh cÃ´ng:', {
            questions: Object.keys(this.questionsData).length + ' categories',
            answers: Object.keys(this.answersData).length + ' categories'
          });

        } catch (error) {
          console.error('Error loading data:', error);
          this.showError(`KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u: ${error.message}\n\nVui lÃ²ng kiá»ƒm tra:\n- File questions.json vÃ  answers.json cÃ³ tá»“n táº¡i?\n- ÄÆ°á»ng dáº«n file cÃ³ Ä‘Ãºng?\n- Cáº¥u trÃºc JSON cÃ³ há»£p lá»‡?`);
        }
      }

      setupEventListeners() {
        // Navigation
        document.querySelectorAll('.nav-btn, .mobile-nav-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            const page = btn.dataset.page;
            this.showPage(page);
            this.updateNavigation(btn);
          });
        });

        // Theme toggle
        document.getElementById('theme-toggle').addEventListener('click', () => {
          this.toggleTheme();
        });

        // Mobile menu
        document.getElementById('mobile-menu-btn').addEventListener('click', () => {
          const menu = document.getElementById('mobile-menu');
          menu.classList.toggle('hidden');
        });

        // Quiz controls
        document.getElementById('check-btn').addEventListener('click', () => this.checkAnswer());
        document.getElementById('next-btn').addEventListener('click', () => this.nextQuestion());
        document.getElementById('close-quiz').addEventListener('click', () => this.closeQuiz());
        document.getElementById('back-to-selection').addEventListener('click', () => this.closeQuiz());
        document.getElementById('retry-wrong').addEventListener('click', () => this.retryWrongAnswers());

        // Results modal
        document.getElementById('retry-exercise').addEventListener('click', () => this.retryCurrentExercise());
        document.getElementById('close-results').addEventListener('click', () => this.closeResults());

        // Answer input
        const answerInput = document.getElementById('answer-input');
        answerInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            if (document.getElementById('check-btn').style.display !== 'none') {
              this.checkAnswer();
            } else if (document.getElementById('next-btn').style.display !== 'none') {
              this.nextQuestion();
            }
          }
        });
      }

      showPage(page) {
        // Hide all pages
        document.querySelectorAll('.page').forEach(p => {
          p.classList.add('hidden');
        });

        // Show selected page
        const targetPage = document.getElementById(`${page}-page`);
        if (targetPage) {
          targetPage.classList.remove('hidden');
          targetPage.classList.add('animate-slide-up');
        }

        this.currentPage = page;

        // Load page-specific content
        if (page === 'review') {
          this.loadReviewContent();
        } else if (page === 'statistics') {
          this.loadStatistics();
        }
      }

      updateNavigation(activeBtn) {
        // Update desktop navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
          btn.classList.remove('bg-blue-500', 'text-white');
          btn.classList.add('text-gray-600', 'dark:text-gray-300', 'hover:bg-gray-100', 'dark:hover:bg-gray-800');
        });

        // Update mobile navigation
        document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
          btn.classList.remove('bg-blue-500', 'text-white');
          btn.classList.add('text-gray-600', 'dark:text-gray-300', 'hover:bg-gray-100', 'dark:hover:bg-gray-800');
        });

        // Set active button
        const page = activeBtn.dataset.page;
        document.querySelectorAll(`[data-page="${page}"]`).forEach(btn => {
          btn.classList.remove('text-gray-600', 'dark:text-gray-300', 'hover:bg-gray-100', 'dark:hover:bg-gray-800');
          btn.classList.add('bg-blue-500', 'text-white');
        });

        // Hide mobile menu
        document.getElementById('mobile-menu').classList.add('hidden');
      }

      toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.classList.contains('dark') ? 'dark' : 'light';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        html.classList.toggle('dark');
        localStorage.setItem('theme', newTheme);
      }

      loadTheme() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
          document.documentElement.classList.add('dark');
        }
      }

      loadGlobalStats() {
        const saved = localStorage.getItem('japaneseAppStats');
        return saved ? JSON.parse(saved) : {
          totalCorrect: 0,
          totalQuestions: 0,
          maxStreak: 0,
          exerciseProgress: {},
          lastAccessed: new Date().toISOString()
        };
      }

      saveGlobalStats() {
        this.globalStats.lastAccessed = new Date().toISOString();
        localStorage.setItem('japaneseAppStats', JSON.stringify(this.globalStats));
      }

      updateStatsDisplay() {
        document.getElementById('correct-count').textContent = this.globalStats.totalCorrect;
        document.getElementById('total-count').textContent = this.globalStats.totalQuestions;
        document.getElementById('streak-count').textContent = this.sessionStats.streak;

        const accuracy = this.globalStats.totalQuestions > 0
          ? Math.round((this.globalStats.totalCorrect / this.globalStats.totalQuestions) * 100)
          : 0;
        document.getElementById('accuracy-rate').textContent = accuracy + '%';
      }

      renderExerciseCards() {
        const container = document.getElementById('exercise-grid');
        container.innerHTML = '';

        Object.entries(this.exerciseDefinitions).forEach(([key, exercise]) => {
          const progress = this.globalStats.exerciseProgress[key] || 0;
          const questions = this.questionsData[key] || [];
          const total = questions.length;
          const progressPercent = total > 0 ? (progress / total) * 100 : 0;

          const colorClasses = {
            blue: 'from-blue-50 to-blue-100 border-blue-200 text-blue-700 dark:from-blue-900/20 dark:to-blue-800/20 dark:border-blue-700 dark:text-blue-300',
            green: 'from-green-50 to-green-100 border-green-200 text-green-700 dark:from-green-900/20 dark:to-green-800/20 dark:border-green-700 dark:text-green-300',
            red: 'from-red-50 to-red-100 border-red-200 text-red-700 dark:from-red-900/20 dark:to-red-800/20 dark:border-red-700 dark:text-red-300',
            purple: 'from-purple-50 to-purple-100 border-purple-200 text-purple-700 dark:from-purple-900/20 dark:to-purple-800/20 dark:border-purple-700 dark:text-purple-300',
            yellow: 'from-yellow-50 to-yellow-100 border-yellow-200 text-yellow-700 dark:from-yellow-900/20 dark:to-yellow-800/20 dark:border-yellow-700 dark:text-yellow-300',
            indigo: 'from-indigo-50 to-indigo-100 border-indigo-200 text-indigo-700 dark:from-indigo-900/20 dark:to-indigo-800/20 dark:border-indigo-700 dark:text-indigo-300',
            orange: 'from-orange-50 to-orange-100 border-orange-200 text-orange-700 dark:from-orange-900/20 dark:to-orange-800/20 dark:border-orange-700 dark:text-orange-300',
            cyan: 'from-cyan-50 to-cyan-100 border-cyan-200 text-cyan-700 dark:from-cyan-900/20 dark:to-cyan-800/20 dark:border-cyan-700 dark:text-cyan-300',
            gray: 'from-gray-50 to-gray-100 border-gray-200 text-gray-700 dark:from-gray-700 dark:to-gray-600 dark:border-gray-600 dark:text-gray-300',
            amber: 'from-amber-50 to-amber-100 border-amber-200 text-amber-700 dark:from-amber-900/20 dark:to-amber-800/20 dark:border-amber-700 dark:text-amber-300',
            violet: 'from-violet-50 to-violet-100 border-violet-200 text-violet-700 dark:from-violet-900/20 dark:to-violet-800/20 dark:border-violet-700 dark:text-violet-300',
            teal: 'from-teal-50 to-teal-100 border-teal-200 text-teal-700 dark:from-teal-900/20 dark:to-teal-800/20 dark:border-teal-700 dark:text-teal-300',
            sky: 'from-sky-50 to-sky-100 border-sky-200 text-sky-700 dark:from-sky-900/20 dark:to-sky-800/20 dark:border-sky-700 dark:text-sky-300'
          };

          const card = document.createElement('div');
          card.className = `bg-gradient-to-br ${colorClasses[exercise.color] || colorClasses.blue} p-6 rounded-xl border-2 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-105 transform group`;
          card.onclick = () => this.startExercise(key);

          card.innerHTML = `
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <i class="${exercise.icon} text-2xl group-hover:scale-110 transition-transform"></i>
                                <h3 class="text-lg font-bold group-hover:text-current">${exercise.title}</h3>
                            </div>
                            ${progress >= total && total > 0 ? '<i class="fas fa-check-circle text-green-500 text-xl animate-pulse"></i>' : ''}
                        </div>
                        
                        <p class="text-sm mb-4 opacity-80 group-hover:opacity-100 transition-opacity">${exercise.description}</p>
                        
                        <div class="mb-3">
                            <div class="flex justify-between text-sm mb-1">
                                <span>Tiáº¿n Ä‘á»™</span>
                                <span>${progress}/${total} cÃ¢u</span>
                            </div>
                            <div class="w-full bg-white/50 dark:bg-gray-800/50 rounded-full h-2 overflow-hidden">
                                <div class="bg-current h-2 rounded-full transition-all duration-500 relative" style="width: ${progressPercent}%">
                                    <div class="absolute inset-0 bg-white/20 animate-pulse"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white/70 dark:bg-gray-800/70 rounded-lg p-3 text-xs opacity-90 group-hover:opacity-100 transition-opacity">
                            ${exercise.theory}
                        </div>
                        
                        ${total === 0 ? '<div class="mt-2 text-xs text-red-600 dark:text-red-400"><i class="fas fa-exclamation-triangle mr-1"></i>ChÆ°a cÃ³ dá»¯ liá»‡u</div>' : ''}
                    `;

          container.appendChild(card);
        });
      }

      startExercise(exerciseKey) {
        if (!this.isDataLoaded) {
          this.showError('Dá»¯ liá»‡u chÆ°a Ä‘Æ°á»£c táº£i xong. Vui lÃ²ng Ä‘á»£i...');
          return;
        }

        const questions = this.questionsData[exerciseKey];
        const answers = this.answersData[exerciseKey];

        if (!questions || !answers || questions.length === 0) {
          this.showError(`KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u cho bÃ i táº­p "${this.exerciseDefinitions[exerciseKey]?.title}". Vui lÃ²ng kiá»ƒm tra file JSON.`);
          return;
        }

        if (questions.length !== answers.length) {
          this.showError(`Sá»‘ lÆ°á»£ng cÃ¢u há»i (${questions.length}) khÃ´ng khá»›p vá»›i sá»‘ lÆ°á»£ng Ä‘Ã¡p Ã¡n (${answers.length}) cho bÃ i táº­p "${this.exerciseDefinitions[exerciseKey]?.title}".`);
          return;
        }

        this.currentExercise = exerciseKey;
        this.currentQuestionIndex = 0;
        this.sessionStats = { correct: 0, total: 0, streak: 0, wrong: 0 };

        // Combine questions and answers
        this.currentQuestions = questions.map((question, index) => ({
          ...question,
          answer: answers[index].answer,
          explanation: answers[index].explanation
        }));

        document.getElementById('quiz-title').textContent = this.exerciseDefinitions[exerciseKey].title;
        document.getElementById('quiz-container').classList.remove('hidden');

        this.loadQuestion();
      }

      generateMockQuestions(exerciseKey) {
        // Mock data for demonstration
        const mockData = {
          'verbs-present': [
            { question: 'ãŒã£ã“ã†ã« ã„ãã¾ã™ã€‚', meaning: '(Ä‘i há»c)', prefix: 'ãŒã£ã“ã†ã«', answer: 'ã„ã' },
            { question: 'ã»ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã€‚', meaning: '(Ä‘á»c sÃ¡ch)', prefix: 'ã»ã‚“ã‚’', answer: 'ã‚ˆã‚€' },
            { question: 'ãˆã„ãŒã‚’ ã¿ã¾ã™ã€‚', meaning: '(xem phim)', prefix: 'ãˆã„ãŒã‚’', answer: 'ã¿ã‚‹' }
          ],
          'verbs-past': [
            { question: 'ãã®ã† ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã€‚', meaning: '(hÃ´m qua Ä‘Ã£ xem phim)', prefix: 'ãã®ã† ãˆã„ãŒã‚’', answer: 'ã¿ãŸ' },
            { question: 'ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸà¥¤', meaning: '(Ä‘Ã£ Äƒn sÃ¡ng)', prefix: 'ã‚ã•ã”ã¯ã‚“ã‚’', answer: 'ãŸã¹ãŸ' }
          ]
        };

        return mockData[exerciseKey] || mockData['verbs-present'];
      }

      loadQuestion() {
        const question = this.currentQuestions[this.currentQuestionIndex];
        if (!question) {
          this.showResults();
          return;
        }

        // Update progress
        const progress = ((this.currentQuestionIndex + 1) / this.currentQuestions.length) * 100;
        document.getElementById('quiz-progress-bar').style.width = progress + '%';
        document.getElementById('quiz-progress-text').textContent = `${this.currentQuestionIndex + 1}/${this.currentQuestions.length}`;

        // Load question content
        document.getElementById('japanese-sentence').textContent = question.question;
        document.getElementById('vietnamese-meaning').textContent = question.meaning;
        document.getElementById('sentence-prefix').textContent = question.prefix;

        // Reset UI
        const answerInput = document.getElementById('answer-input');
        answerInput.value = '';
        answerInput.focus(); // Fix: Auto focus on input
        document.getElementById('feedback').innerHTML = '';
        document.getElementById('check-btn').classList.remove('hidden');
        document.getElementById('next-btn').classList.add('hidden');
      }

      checkAnswer() {
        const question = this.currentQuestions[this.currentQuestionIndex];
        const userAnswer = document.getElementById('answer-input').value.trim().toLowerCase();
        const correctAnswer = question.answer.toLowerCase();

        if (!userAnswer) {
          document.getElementById('answer-input').focus();
          return;
        }

        const isCorrect = userAnswer === correctAnswer;
        this.sessionStats.total++;
        this.globalStats.totalQuestions++;

        if (isCorrect) {
          this.sessionStats.correct++;
          this.sessionStats.streak++;
          this.globalStats.totalCorrect++;
          this.globalStats.maxStreak = Math.max(this.globalStats.maxStreak, this.sessionStats.streak);
          this.updateExerciseProgress();

          document.getElementById('feedback').innerHTML = `
                        <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 text-green-700 dark:text-green-300 p-4 rounded-xl animate-bounce-in">
                            <i class="fas fa-check-circle mr-2"></i>
                            ChÃ­nh xÃ¡c! ÄÃ¡p Ã¡n Ä‘Ãºng lÃ : <strong class="font-japanese">${question.answer}</strong>
                            ${question.explanation ? `<br><small class="opacity-80">${question.explanation}</small>` : ''}
                        </div>
                    `;
        } else {
          this.sessionStats.wrong++;
          this.sessionStats.streak = 0;

          // Save wrong answer for review
          this.wrongAnswers.push({
            question: question.question,
            userAnswer: userAnswer,
            correctAnswer: question.answer,
            meaning: question.meaning,
            explanation: question.explanation,
            prefix: question.prefix,
            exerciseType: this.currentExercise,
            timestamp: new Date().toISOString()
          });
          localStorage.setItem('wrongAnswers', JSON.stringify(this.wrongAnswers));

          document.getElementById('feedback').innerHTML = `
                        <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 text-red-700 dark:text-red-300 p-4 rounded-xl animate-bounce-in">
                            <i class="fas fa-times-circle mr-2"></i>
                            ChÆ°a Ä‘Ãºng! ÄÃ¡p Ã¡n Ä‘Ãºng lÃ : <strong class="font-japanese">${question.answer}</strong><br>
                            <small>Báº¡n Ä‘Ã£ nháº­p: "${userAnswer}"</small>
                            ${question.explanation ? `<br><small class="opacity-80">${question.explanation}</small>` : ''}
                        </div>
                    `;
        }

        document.getElementById('check-btn').classList.add('hidden');
        document.getElementById('next-btn').classList.remove('hidden');

        this.updateStatsDisplay();
        this.saveGlobalStats();
      }

      nextQuestion() {
        this.currentQuestionIndex++;

        if (this.currentQuestionIndex >= this.currentQuestions.length) {
          this.showResults();
        } else {
          this.loadQuestion();
        }
      }

      updateExerciseProgress() {
        const key = this.currentExercise;
        if (!this.globalStats.exerciseProgress[key]) {
          this.globalStats.exerciseProgress[key] = 0;
        }
        this.globalStats.exerciseProgress[key]++;
      }

      showResults() {
        document.getElementById('quiz-container').classList.add('hidden');

        const { correct, total, wrong } = this.sessionStats;
        const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

        document.getElementById('final-score').textContent = `${correct}/${total}`;
        document.getElementById('final-correct').textContent = correct;
        document.getElementById('final-wrong').textContent = wrong;
        document.getElementById('final-skipped').textContent = 0;

        let message = '';
        if (percentage >= 90) {
          message = 'ğŸ‰ Xuáº¥t sáº¯c! Báº¡n Ä‘Ã£ lÃ m ráº¥t tá»‘t!';
        } else if (percentage >= 70) {
          message = 'ğŸ‘ Tá»‘t láº¯m! Tiáº¿p tá»¥c cá»‘ gáº¯ng!';
        } else if (percentage >= 50) {
          message = 'ğŸ˜Š KhÃ´ng tá»‡! HÃ£y Ã´n láº¡i vÃ  thá»­ láº§n ná»¯a!';
        } else {
          message = 'ğŸ’ª Äá»«ng náº£n lÃ²ng! HÃ£y Ã´n láº¡i lÃ½ thuyáº¿t vÃ  thá»­ láº¡i!';
        }

        document.getElementById('final-message').textContent = message;
        document.getElementById('results-modal').classList.remove('hidden');

        // Update exercise cards
        this.renderExerciseCards();
      }

      retryCurrentExercise() {
        document.getElementById('results-modal').classList.add('hidden');
        this.startExercise(this.currentExercise);
      }

      closeResults() {
        document.getElementById('results-modal').classList.add('hidden');
        this.showPage('practice');
      }

      closeQuiz() {
        document.getElementById('quiz-container').classList.add('hidden');
        this.showPage('practice');
      }

      retryWrongAnswers() {
        if (this.wrongAnswers.length === 0) {
          alert('KhÃ´ng cÃ³ cÃ¢u sai Ä‘á»ƒ Ã´n táº­p!');
          return;
        }

        // Convert wrong answers to quiz format
        this.currentQuestions = this.wrongAnswers.map(item => ({
          question: item.question,
          answer: item.correctAnswer,
          meaning: item.meaning,
          prefix: item.question.split(' ').slice(0, -1).join(' ')
        }));

        this.currentExercise = 'review';
        this.currentQuestionIndex = 0;
        this.sessionStats = { correct: 0, total: 0, streak: 0, wrong: 0 };

        document.getElementById('quiz-title').textContent = 'Ã”n Táº­p CÃ¢u Sai';
        document.getElementById('quiz-container').classList.remove('hidden');

        this.loadQuestion();
      }

      loadReviewContent() {
        const container = document.getElementById('review-content');

        if (this.wrongAnswers.length === 0) {
          container.innerHTML = `
                        <div class="text-center py-12">
                            <i class="fas fa-check-circle text-6xl text-green-500 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-2">Tuyá»‡t vá»i!</h3>
                            <p class="text-gray-600 dark:text-gray-400 mb-6">Báº¡n chÆ°a cÃ³ cÃ¢u nÃ o sai Ä‘á»ƒ Ã´n táº­p.</p>
                            <button onclick="app.showPage('practice')" class="px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-medium transition-colors">
                                LÃ m BÃ i Táº­p Má»›i
                            </button>
                        </div>
                    `;
          return;
        }

        container.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">CÃ¢u Sai Cáº§n Ã”n Táº­p (${this.wrongAnswers.length})</h3>
                        <div class="space-x-3">
                            <button onclick="app.retryWrongAnswers()" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
                                <i class="fas fa-play mr-2"></i>Ã”n Táº­p Ngay
                            </button>
                            <button onclick="app.clearWrongAnswers()" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors">
                                <i class="fas fa-trash mr-2"></i>XÃ³a Táº¥t Cáº£
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid gap-4">
                        ${this.wrongAnswers.map((item, index) => `
                            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-start mb-3">
                                    <div class="flex-1">
                                        <div class="font-japanese text-lg mb-1">${item.question}</div>
                                        <div class="text-gray-600 dark:text-gray-400 text-sm mb-2">${item.meaning}</div>
                                        <div class="flex items-center space-x-4 text-sm">
                                            <span class="text-red-600 dark:text-red-400">
                                                <i class="fas fa-times mr-1"></i>Báº¡n tráº£ lá»i: ${item.userAnswer}
                                            </span>
                                            <span class="text-green-600 dark:text-green-400">
                                                <i class="fas fa-check mr-1"></i>ÄÃ¡p Ã¡n Ä‘Ãºng: ${item.correctAnswer}
                                            </span>
                                        </div>
                                    </div>
                                    <button onclick="app.removeWrongAnswer(${index})" class="text-gray-400 hover:text-red-500 transition-colors">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
      }

      clearWrongAnswers() {
        if (confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a táº¥t cáº£ cÃ¢u sai?')) {
          this.wrongAnswers = [];
          localStorage.removeItem('wrongAnswers');
          this.loadReviewContent();
        }
      }

      removeWrongAnswer(index) {
        this.wrongAnswers.splice(index, 1);
        localStorage.setItem('wrongAnswers', JSON.stringify(this.wrongAnswers));
        this.loadReviewContent();
      }

      loadStatistics() {
        const container = document.getElementById('exercise-progress');
        container.innerHTML = '';

        Object.entries(this.exerciseDefinitions).forEach(([key, exercise]) => {
          const progress = this.globalStats.exerciseProgress[key] || 0;
          const questions = this.questionsData[key] || [];
          const total = questions.length;
          const percentage = total > 0 ? (progress / total) * 100 : 0;

          const progressItem = document.createElement('div');
          progressItem.className = 'flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors';
          progressItem.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <i class="${exercise.icon} text-${exercise.color}-500"></i>
                            <div>
                                <div class="font-medium">${exercise.title}</div>
                                <div class="text-xs text-gray-500 dark:text-gray-400">${total} cÃ¢u há»i</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-24 bg-gray-200 dark:bg-gray-600 rounded-full h-2 overflow-hidden">
                                <div class="bg-${exercise.color}-500 h-2 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                            </div>
                            <span class="text-sm text-gray-600 dark:text-gray-400 min-w-[50px] text-right">${progress}/${total}</span>
                            ${percentage >= 100 ? '<i class="fas fa-check-circle text-green-500"></i>' : ''}
                        </div>
                    `;
          container.appendChild(progressItem);
        });

        // Add summary stats
        const totalQuestions = Object.keys(this.questionsData).reduce((sum, key) => {
          return sum + (this.questionsData[key]?.length || 0);
        }, 0);

        const completedQuestions = Object.keys(this.exerciseDefinitions).reduce((sum, key) => {
          return sum + (this.globalStats.exerciseProgress[key] || 0);
        }, 0);

        const summaryItem = document.createElement('div');
        summaryItem.className = 'mt-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-700 dark:to-gray-600 rounded-xl border border-blue-200 dark:border-gray-600';
        summaryItem.innerHTML = `
                    <h4 class="font-bold text-lg mb-3 text-gray-800 dark:text-gray-200">ğŸ“Š Tá»•ng Quan</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div>
                            <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">${totalQuestions}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Tá»•ng cÃ¢u há»i</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-green-600 dark:text-green-400">${completedQuestions}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">ÄÃ£ hoÃ n thÃ nh</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">${this.globalStats.maxStreak}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Streak cao nháº¥t</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-orange-600 dark:text-orange-400">${this.wrongAnswers.length}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">CÃ¢u cáº§n Ã´n</div>
                        </div>
                    </div>
                `;
        container.appendChild(summaryItem);
      }

      setupKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
          if (e.target.tagName === 'INPUT') return;

          switch (e.key) {
            case '1':
              this.showPage('theory');
              break;
            case '2':
              this.showPage('practice');
              break;
            case '3':
              this.showPage('review');
              break;
            case '4':
              this.showPage('statistics');
              break;
            case 'Escape':
              this.closeQuiz();
              break;
          }
        });
      }

      hideLoadingScreen() {
        setTimeout(() => {
          document.getElementById('loading-screen').classList.add('hidden');
        }, 1000);
      }

      showError(message) {
        // Create error modal
        const errorModal = document.createElement('div');
        errorModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
        errorModal.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md p-6">
                        <div class="text-center">
                            <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                            <h3 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-200">Lá»—i</h3>
                            <p class="text-gray-600 dark:text-gray-400 mb-6 whitespace-pre-line">${message}</p>
                            <button onclick="this.closest('.fixed').remove()" class="px-6 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors">
                                <i class="fas fa-times mr-2"></i>ÄÃ³ng
                            </button>
                        </div>
                    </div>
                `;
        document.body.appendChild(errorModal);

        // Auto remove after 10 seconds
        setTimeout(() => {
          if (errorModal.parentNode) {
            errorModal.remove();
          }
        }, 10000);
      }
    }

    // Initialize app
    let app;
    document.addEventListener('DOMContentLoaded', () => {
      app = new JapaneseApp();
    });
  </script>
</body>

</html>